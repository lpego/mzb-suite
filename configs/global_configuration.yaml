
# Arguments not to be spec via CLI
glob_random_seed: 222 

# Image parsing specific 
impa_image_format: jpg
impa_clip_areas: [2750, 4900]
impa_gaussian_blur: [21, 21]
impa_gaussian_blur_passes: 3
impa_adaptive_threshold: 351
impa_mask_postprocess_kernel: [11, 11]
impa_mask_postprocess_passes: 5
impa_save_full_mask_dir: data/derived/project_portable_flume/full_image_masks
impa_bounding_box_buffer: 200
impa_save_clips_plus_features: True

# Run classification routine on image clips 
## Preparation of learning sets (run once if output folder is not there)
## these data will need to be doctored, to move classes like errors 
## and such into specific subfolers
lset_class_cut: order
lset_val_size: 0.1
lset_taxonomy: data/MZB_taxonomy.csv

## Finetuning / training config for classifier
trcl_learning_rate: 0.001
trcl_batch_size: 16
trcl_weight_decay: 0
trcl_step_size_decay: 5
trcl_number_epochs: 75
trcl_gpu_ids: -1
trcl_save_topk: 1
trcl_num_classes: 8
trcl_model_pretrarch: efficientnet-b2 #convnext-small
trcl_num_workers: 16
# trai_model_save_append: "-v1"

## Finetuning / training config for skeleton prediction
trsk_learning_rate: 0.001
trsk_batch_size: 16
trsk_weight_decay: 0
trsk_step_size_decay: 25
trsk_number_epochs: 10
trsk_gpu_ids: -1
trsk_save_topk: 1
trsk_num_classes: 2
trsk_model_pretrarch: mit-b2
trsk_num_workers: 16
# trai_model_save_append: "-v1"

## Inference config 
infe_model_folder: models/mzb-class/ # likely not used to allow renku parse as input
infe_model_ckpt: last
infe_num_classes: 8
infe_image_glob: "*_rgb.png"

## Skeletonization
# unsupervised skeletonization
skel_class_exclude: errors
skel_conv_rate: 131.6625 #[133.1, 136.6, 133.2, 133.2, 133.2, 118.6, 133.4, 132.0])  # px / mm
skel_save_usnup_masks: data/derived/project_portable_flume/skeletons/automatic_skeletons/

# supervised skeletonization
skel_save_attributes: data/derived/project_portable_flume/skeletons/
skel_save_sup_masks: data/derived/project_portable_flume/skeletons/supervised_skeletons/
skel_label_thickness: 3
skel_label_buffer_on_preds: 25 